<!doctype html>
<html lang="en" ng-app="Instanto">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Instanto</title>
    <link rel="stylesheet" href="css/bootstrap.min.css"/>
    <link rel="stylesheet" href="css/login.css"/>
    <script type="text/javascript" src="js/superagent.js"></script>
  </head>
  <body>
    <div class="container">
      <form class="form-signin" role="form" id="login-form">
        <label for="username" class="sr-only">Username</label>
        <input type="text" id="inputUsername" class="form-control" placeholder="Username" required autofocus>
        <label for="inputPassword" class="sr-only">Password</label>
        <input type="password" id="inputPassword" class="form-control" placeholder="Password" required>
        <!--
        <div class="checkbox">
          <label>
            <input type="checkbox" value="remember-me"> Remember me
          </label>
        </div>
        -->
        <button class="btn btn-lg btn-primary btn-block" type="submit">Login</button>
      </form>
      <br>
      <p id="info"></p>
    </div>
  </body>
</html>
<script type="text/javascript">
  var form = document.getElementById("login-form");
  form.addEventListener('submit', login);

  function login(event) {

    event.preventDefault();
    var username = document.getElementById("inputUsername").value;
    var password = document.getElementById("inputPassword").value;

  superagent
    .post('http://localhost:3000/api/login')
    .send({ username: username, password: password })
    .end(function(res){
      if (res.ok) {
        var data = res.body;
        localStorage.setItem("instanto_token", data.token);
        window.location.href = "/instanto_app_admin/";
      } else {
        console.info("bad password/username");
      }
    });

  }
</script>
